<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙŠ - Modern</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f4f6f8; --card:#ffffff; --muted:#6b7280; --accent:#7c3aed;
    --glass: rgba(255,255,255,0.6);
  }
  [data-theme='dark']{--bg:#0b1020;--card:#061126;--muted:#9aa4b2;--glass: rgba(255,255,255,0.03)}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto;color:var(--muted);background:var(--bg);min-height:100vh}
  .app{max-width:1100px;margin:18px auto;padding:12px}
  .top{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:18px}
  .brand{font-weight:700;color:var(--accent);font-size:20px}
  .controls{display:flex;gap:8px;align-items:center}
  .searchbox{background:var(--card);padding:8px;border-radius:12px;display:flex;gap:8px;align-items:center;width:320px;box-shadow:0 6px 18px rgba(16,24,40,0.06)}
  .searchbox input{border:0;background:transparent;outline:none;padding:6px}
  .view{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
  .note{background:var(--card);padding:14px;border-radius:14px;min-height:110px;position:relative;box-shadow:0 8px 30px rgba(2,6,23,0.06);transition:transform .18s,box-shadow .18s}
  .note:hover{transform:translateY(-6px);box-shadow:0 20px 40px rgba(2,6,23,0.12)}
  .note h4{margin:0 0 8px;color:#0f1724}
  .note p{margin:0;color:var(--muted);white-space:pre-wrap}
  .note .foot{position:absolute;left:12px;bottom:12px;font-size:12px;color:var(--muted)}
  .fab{position:fixed;bottom:22px;left:22px;background:var(--accent);color:#fff;border:0;border-radius:12px;padding:12px 16px;font-size:16px;box-shadow:0 14px 30px rgba(124,58,237,0.18);cursor:pointer}
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(0deg,rgba(2,6,23,0.45),rgba(2,6,23,0.45))}
  .modal .box{width:100%;max-width:720px;background:var(--card);padding:16px;border-radius:12px}
  input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ef;background:transparent;outline:none}
  .row{display:flex;gap:8px;margin-top:8px;align-items:center}
  .tiny{font-size:13px;color:var(--muted)}
  .color-palette{display:flex;gap:8px}
  .sw{padding:8px;border-radius:8px;background:var(--card);cursor:pointer;border:1px solid rgba(0,0,0,0.05)}
  @media (max-width:640px){
    .top{flex-direction:column;align-items:stretch;gap:10px}
    .searchbox{width:100%}
  }
</style>
</head>
<body data-theme="light">
<div class="app">
  <div class="top">
    <div class="brand">Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙŠ â€” Ù…ÙˆØ¯Ø±Ù†</div>
    <div class="controls">
      <div class="searchbox"><input id="q" placeholder="Ø§Ø¨Ø­Ø«..." /></div>
      <button class="sw" id="toggleTheme">ÙˆØ¶Ø¹ Ø¯Ø§ÙƒÙ†</button>
      <button class="sw" id="openNew">Ø£Ø¶Ù</button>
    </div>
  </div>

  <div id="view" class="view"></div>
</div>

<button class="fab" id="fab">+</button>

<div class="modal" id="modal">
  <div class="box">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <strong>Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø©</strong>
      <button onclick="closeModal()" class="sw">âœ•</button>
    </div>
    <div style="margin-top:10px">
      <input id="title" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" />
      <textarea id="body" placeholder="Ø§Ù„Ù†Øµ ..." style="min-height:120px"></textarea>
      <div class="row">
        <select id="group"></select>
        <div class="color-palette" id="palette"></div>
        <button class="sw" id="save">Ø­ÙØ¸</button>
      </div>
    </div>
  </div>
</div>

<script>
/* Modern app */
const paletteColors = ['#fff8e1','#ffebee','#e8f5e9','#e3f2fd','#f3e5f5'];
let groups = JSON.parse(localStorage.getItem('m_groups')||'["Ø§Ù„ÙƒÙ„","Today","Work"]');
let notes = JSON.parse(localStorage.getItem('m_notes')||'[]');
let editing = null;
let selectedColor = paletteColors[0];

const view = document.getElementById('view');
const modal = document.getElementById('modal');

function save(){ localStorage.setItem('m_notes',JSON.stringify(notes)); localStorage.setItem('m_groups',JSON.stringify(groups)); }
function renderPalette(){
  const pal = document.getElementById('palette'); pal.innerHTML='';
  paletteColors.forEach(c=>{
    const d = document.createElement('div'); d.style.width='28px'; d.style.height='28px'; d.style.borderRadius='8px'; d.style.background=c; d.style.cursor='pointer';
    d.onclick = ()=>{ selectedColor=c; Array.from(pal.children).forEach(ch=>ch.style.outline='none'); d.style.outline='3px solid rgba(0,0,0,0.08)'; }
    pal.appendChild(d);
  });
}
function renderGroups(){
  const gsel = document.getElementById('group'); gsel.innerHTML = groups.map(x=>`<option>${x}</option>`).join('');
}
function sampleIfEmpty(){
  if(!notes.length){
    notes = [{id:Date.now().toString(),title:'Ø£ÙÙƒØ§Ø± Ù„Ù„ØªØ·Ø¨ÙŠÙ‚',content:'1. ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø³ÙŠØ·Ø©\n2. Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ',color:paletteColors[2],group:'Work',pinned:false}];
    save();
  }
}
function render(){
  view.innerHTML='';
  const q = document.getElementById('q').value.toLowerCase();
  notes.forEach(n=>{
    if(q && !(n.title+n.content+n.group).toLowerCase().includes(q)) return;
    const card = document.createElement('div'); card.className='note'; card.style.background=n.color; card.draggable=true;
    card.innerHTML = `<h4>${n.title||''}</h4><p>${n.content||''}</p><div class="foot">${n.group}${n.pinned?' â€¢ ğŸ“Œ':''}</div>`;
    // actions
    const tools = document.createElement('div'); tools.style.position='absolute'; tools.style.left='12px'; tools.style.top='12px';
    const pin = document.createElement('button'); pin.className='sw'; pin.innerText=n.pinned?'Ø¥Ù„ØºØ§Ø¡ ØªØ«Ø¨ÙŠØª':'ØªØ«Ø¨ÙŠØª'; pin.onclick=e=>{ e.stopPropagation(); n.pinned=!n.pinned; save(); render(); };
    const edit = document.createElement('button'); edit.className='sw'; edit.innerText='âœï¸'; edit.onclick=e=>{ e.stopPropagation(); openModal(n) };
    const del = document.createElement('button'); del.className='sw'; del.innerText='ğŸ—‘ï¸'; del.onclick=e=>{ e.stopPropagation(); if(confirm('Ø­Ø°ÙØŸ')){ notes=notes.filter(x=>x.id!==n.id); save(); render(); } };
    tools.appendChild(pin); tools.appendChild(edit); tools.appendChild(del); card.appendChild(tools);

    card.addEventListener('dragstart', e=> e.dataTransfer.setData('id', n.id));
    card.addEventListener('click', ()=> { navigator.clipboard.writeText((n.title?n.title+'\n':'')+n.content); card.style.transform='scale(.99)'; setTimeout(()=>card.style.transform='scale(1)',130); });

    view.appendChild(card);
  });
}

function openModal(note){
  editing = note?note.id:null;
  modal.style.display='flex';
  document.getElementById('title').value = note?note.title:'';
  document.getElementById('body').value = note?note.content:'';
  selectedColor = note?note.color:selectedColor;
  renderGroups();
}
function closeModal(){ modal.style.display='none'; editing=null; }

document.getElementById('fab').onclick = ()=> openModal();
document.getElementById('openNew').onclick = ()=> openModal();
document.getElementById('save').onclick = ()=>{
  const title = document.getElementById('title').value.trim();
  const content = document.getElementById('body').value.trim();
  const group = document.getElementById('group').value || groups[0];
  if(!title && !content) return alert('Ø§ÙƒØªØ¨ Ø´ÙŠØ¦Ø§Ù‹');
  if(editing){
    const n = notes.find(x=>x.id===editing);
    n.title=title; n.content=content; n.color=selectedColor; n.group=group;
  } else {
    notes.unshift({id:Date.now().toString(),title,content,color:selectedColor,group,pinned:false});
  }
  save(); render(); closeModal();
};

document.getElementById('q').addEventListener('input', render);

// drag drop to top
view.addEventListener('dragover', e=> e.preventDefault());
view.addEventListener('drop', e=>{
  const id = e.dataTransfer.getData('id');
  const idx = notes.findIndex(x=>x.id===id);
  if(idx>=0){ const [it]=notes.splice(idx,1); notes.unshift(it); save(); render(); }
});

// theme toggle
const themeBtn = document.getElementById('toggleTheme');
themeBtn.onclick = ()=>{
  const el = document.body;
  const cur = el.getAttribute('data-theme')==='dark'?'light':'dark';
  el.setAttribute('data-theme',cur);
  themeBtn.innerText = cur==='dark'?'ÙˆØ¶Ø¹ ÙØ§ØªØ­':'ÙˆØ¶Ø¹ Ø¯Ø§ÙƒÙ†';
};

renderPalette();
sampleIfEmpty();
renderGroups();
render();
</script>
</body>
</html>
